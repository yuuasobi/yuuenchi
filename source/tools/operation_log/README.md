# デスクトップアプリ操作ログ＋リソース監視ツール

ユーザーの操作（マウスクリック、キーボード入力）とアクティブなアプリケーションのリソース使用状況（CPU使用率、メモリ使用量）を記録するPython製デスクトップアプリケーションです。

## 機能

- **操作監視**: マウスクリック、キーボード入力、マウススクロールをリアルタイムで記録
- **アクティブウィンドウ監視**: 現在アクティブなウィンドウの情報を取得
- **リソース監視**: アクティブなプロセスのCPU使用率とメモリ使用量を監視
- **CSV出力**: 時系列でログをCSVファイルに記録
- **統計機能**: ログファイルの統計情報を取得
- **フィルタリング**: 条件に基づいてログをフィルタリング・エクスポート

## インストール

### 1. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 2. 必要なパッケージ

- `pynput`: マウス・キーボード入力監視
- `psutil`: プロセス・システム情報取得
- `PyGetWindow`: アクティブウィンドウ情報取得

## 使用方法

### GUIアプリケーション（推奨）

```bash
# Python直接実行
python gui_app.py

# Windows用バッチファイル
start_gui.bat

# PowerShell用スクリプト
.\start_gui.ps1
```

GUIアプリケーションでは以下の機能が利用できます：
- 監視の開始・停止ボタン
- ログファイルの選択
- リアルタイムログ表示
- 統計情報の表示
- ログファイルの直接開封

### コマンドライン版

```bash
# 基本的な使用方法
python operation_log.py

# 出力ファイルを指定
python operation_log.py -o my_log.csv

# Windows用バッチファイル
start_monitoring.bat

# PowerShell用スクリプト
.\start_monitoring.ps1
```

### 停止方法

- **GUI版**: 「監視停止」ボタンをクリック
- **コマンドライン版**: `Ctrl+C` で監視を停止

## ログファイル形式

CSVファイルには以下の列が含まれます：

| 列名 | 説明 |
|------|------|
| timestamp | タイムスタンプ |
| event_type | イベントタイプ（mouse_click, key_press等） |
| window_title | アクティブウィンドウのタイトル |
| process_name | プロセス名 |
| pid | プロセスID |
| cpu_percent | CPU使用率（%） |
| memory_mb | メモリ使用量（MB） |
| memory_percent | メモリ使用率（%） |
| mouse_x | マウスX座標 |
| mouse_y | マウスY座標 |
| status | プロセスステータス |
| error | エラー情報 |

## モジュール構成

### `gui_app.py`
GUIアプリケーション版。tkinterを使用したユーザーフレンドリーなインターフェースを提供します。

### `operation_log.py`
メインの実行制御モジュール。全体の監視処理を統合し、各モジュールを連携させます。

### `input_logger.py`
操作監視処理モジュール。pynputを使用してマウスとキーボード入力を監視し、アクティブウィンドウの情報を取得します。

### `process_monitor.py`
プロセス監視処理モジュール。psutilを使用してCPU使用率とメモリ使用量を監視します。

### `log_writer.py`
ログの出力処理モジュール。CSVファイルに時系列でログを記録します。

## イベントタイプ

記録されるイベントタイプ：

- `mouse_press_left`: 左クリック押下
- `mouse_release_left`: 左クリック離上
- `mouse_press_right`: 右クリック押下
- `mouse_release_right`: 右クリック離上
- `mouse_scroll_up`: マウススクロール上
- `mouse_scroll_down`: マウススクロール下
- `key_press_[文字]`: キー押下
- `key_release_[文字]`: キー離上
- `monitoring`: 定期的な監視

## 注意事項

### セキュリティ
- このツールはすべてのキーボード入力を記録します
- パスワードや機密情報が含まれる可能性があります
- ログファイルは適切に管理してください

### パフォーマンス
- 長時間の監視はログファイルサイズが大きくなる可能性があります
- 定期的にログファイルのローテーションを検討してください

### 権限
- Windowsでの実行時、管理者権限が必要な場合があります
- 一部のアプリケーションではアクセスが制限される場合があります

## トラブルシューティング

### よくある問題

1. **アクセス拒否エラー**
   - 管理者権限で実行してください
   - アンチウイルスソフトの設定を確認してください

2. **プロセス情報が取得できない**
   - システムプロセスや保護されたプロセスは情報が制限される場合があります

3. **ログファイルが作成されない**
   - 書き込み権限を確認してください
   - ディスク容量を確認してください

## ライセンス

このツールはMITライセンスの下で提供されています。

## 貢献

バグ報告や機能要望は、GitHubのIssueでお知らせください。 